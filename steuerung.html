<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Alarmsteuerung</title>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<style>
  body { font-family: Arial; background: #f7f7f7; margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
  .container { background: white; padding: 30px; border-radius: 8px; width: 320px; box-shadow: 0 0 15px #ccc; text-align: center; }
  h2 { margin-bottom: 20px; }
  button { margin: 10px 5px; padding: 12px 20px; font-size: 1em; border: none; border-radius: 5px; cursor: pointer; }
  button#arm { background: #28a745; color: white; }
  button#disarm { background: #dc3545; color: white; }
  button:hover { opacity: 0.9; }
  .ae-controls button { width: 80px; }
  #ae-value { font-size: 1.5em; margin: 20px 0; }
  #status { margin: 15px 0; font-weight: bold; }
  #back { background: #007bff; color: white; margin-top: 20px; width: 100%; }
</style>
</head>
<body>

<div class="container">
  <h2>Alarmsteuerung</h2>
  <div>
    <button id="arm">Alarm schärfen</button>
    <button id="disarm">Alarm entschärfen</button>
  </div>

  <div class="ae-controls">
    <button id="ae-decrease">- 10cm</button>
    <span id="ae-value">AE: 50 cm</span>
    <button id="ae-increase">+ 10cm</button>
  </div>

  <div id="status">Status: Alarm entschärft</div>

  <button id="back">Zurück zum Dashboard</button>
</div>

<script>
  const supabase = supabase.createClient(
    "https://rshbpsxqbabpxhdztozz.supabase.co",
    "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJzaGJwc3hxYmFicHhoZHp0b3p6Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzNjYyMDgsImV4cCI6MjA2NTk0MjIwOH0.4MG6d3QkPv7hj7PcCacZgXp-8YRD_2ANHd7bvFzxtX4"
  );

  let armed = false;
  let ae = 50; // Startwert in cm

  async function checkUser() {
    const { data, error } = await supabase.auth.getUser();
    if (error || !data.user) {
      window.location.href = "index.html";
    }
  }

  function updateStatus() {
    const statusEl = document.getElementById("status");
    statusEl.textContent = "Status: Alarm " + (armed ? "geschärft" : "entschärft");
    statusEl.style.color = armed ? "#28a745" : "#dc3545";
  }

  document.getElementById("arm").addEventListener("click", () => {
    armed = true;
    updateStatus();
    // Hier: Alarm schärfen Logik ergänzen (z.B. Backend Update)
  });

  document.getElementById("disarm").addEventListener("click", () => {
    armed = false;
    updateStatus();
    // Hier: Alarm entschärfen Logik ergänzen
  });

  document.getElementById("ae-increase").addEventListener("click", () => {
    ae += 10;
    if (ae > 200) ae = 200; // Max 200 cm
    document.getElementById("ae-value").textContent = "AE: " + ae + " cm";
    // Hier AE-Update speichern
  });

  document.getElementById("ae-decrease").addEventListener("click", () => {
    ae -= 10;
    if (ae < 10) ae = 10; // Min 10 cm
    document.getElementById("ae-value").textContent = "AE: " + ae + " cm";
    // Hier AE-Update speichern
  });

  document.getElementById("back").addEventListener("click", () => {
    window.location.href = "dashboard.html";
  });

  checkUser();
  updateStatus();
</script>

</body>
</html>
